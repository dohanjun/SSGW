<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{common/layouts/default_layout}"
	layout:fragment="content">

<head>
<link
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
	rel="stylesheet">
<meta charset="UTF-8">
<title>자료실</title>
</head>
<body>
	<form id="moveForm" th:action="@{/basket/moveToBasket}" method="post">
		<input type="hidden" name="repositoryType" value="전체" />
		<div class="card shadow mb-4" style="width: 100%; margin-top: 20px; margin-bottom: auto;">
			<div class="card-header py-3">
				<h6 class="m-0 font-weight-bold text-primary" th:text="${repository.fileRepositoryType}">전체 자료실</h6>
			</div>
			<div class="card-body">
				<div class="table-responsive">
					<div class="position-relative" style="width: 350px; margin: 0 auto;">
						<input type="text" class="form-control pl-4" placeholder="검색어 입력">
						<i class="fas fa-search position-absolute"
							style="top: 50%; left: 10px; transform: translateY(-50%); color: #aaa;"></i>
					</div>
					<div class="text-right mb-3">
						<a class="btn btn-primary"  th:href='@{/repositoryInsert}'>동륵</a>
					</div>
					<table class="table table-bordered" id="dataTable" width="100%"
						cellspacing="0">
						<thead>
						    <tr>
            					<td><input type="checkbox" id="selectAll"></td>
           						<td>자료이름</td>
            					<td>파일명</td>
            					<td>작성자</td>
            					<td>작성일</td>
        				    </tr>
						</thead>
						<tbody>
							<tr th:each="post : ${totalRepositoryList}" 
      							th:data-url="@{'/detailPost/' + ${post.writingId}}"
      							onclick="location.href=this.dataset.url"
      							style="cursor: pointer;">
								<td><input type="checkbox" name="writingIds" th:value="${post.writingId}" class="file-checkbox" onclick="event.stopPropagation()"></td>
           						<td th:text="${post.title}"></td>
            					<td th:text="${post.fileCount > 1 ? post.fileName + ' 외 ' + (post.fileCount - 1) + '건' : post.fileName}"></td>
            					<td th:text="${post.writer}"></td>
            					<td th:text="${#dates.format(post.creationDate, 'yyyy-MM-dd')}"></td>
							</tr>
						</tbody>
					</table>
					<div class="d-flex align-items-center justify-content-between mt-3">
						<!-- 왼쪽: 휴지통 버튼 -->
						<div>
							<button type="submit" class="btn btn-danger">
								<i class="fas fa-trash"></i>
							</button>
						</div>

						<div class="flex-grow-1 d-flex justify-content-center">
							<nav aria-label="페이지네이션">
								<ul class="pagination mb-0">
									<li class="page-item disabled">
										<a class="page-link" href="#" tabindex="-1">
											&laquo;
										</a>
									</li>
									<li class="page-item active"><a class="page-link" href="#">1</a></li>
									<li class="page-item"><a class="page-link" href="#">2</a></li>
									<li class="page-item"><a class="page-link" href="#">3</a></li>
									<li class="page-item">
										<a class="page-link" href="#">
											&raquo;
										</a>
									</li>
								</ul>
							</nav>
						</div>
					</div>
				</div>
			</div>
		</div>
	</form>
</body>
</html>
<script>
	document.getElementById('selectAll').addEventListener('change', function () {
		const checkboxes = document.querySelectorAll('input[name="writingIds"]');
		checkboxes.forEach(cb => cb.checked = this.checked);
	});
</script>