<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yedam.app.group.mapper.AttendanceMapper">


    <!-- 모든 출결 데이터 조회 -->
    <select id="selectAllList" resultType="com.yedam.app.group.service.AttendanceManagementVO">
        SELECT employee_no, attendance_date, clock_in_time, clock_out_time, 
               work_attitude_type, reason, total_working_hours
        FROM attendance_management
        ORDER BY attendance_date DESC
    </select>

    <!-- 특정 사원의 출결 데이터 조회 -->
    <select id="selectList" parameterType="int" resultType="com.yedam.app.group.service.AttendanceManagementVO">
        SELECT employee_no, attendance_date, clock_in_time, clock_out_time, 
               work_attitude_type, reason, total_working_hours
        FROM attendance_management
        WHERE employee_no = #{employeeNo}
        ORDER BY attendance_date DESC
    </select>


<insert id="insertAttend" parameterType="AttendanceManagementVO">
<selectKey keyProperty="workAttitudeId"
			resultType="Integer"
			order="BEFORE">
SELECT NVL(MAX(work_attitude_id), 1) +1
FROM attendance_management
</selectKey>  
	INSERT INTO attendance_management (work_attitude_id
                                        , attendance_date
                                        , clock_in_time
                                        , work_attitude_type
                                        , approval_datetime
                                        , employee_no
                                        , reason
                                        , total_working_hours)
                                        values(${workAttitudeId}
                                              , ${attendanceDate}
                                              , ${clockInTime}
                                              , ${workAttitudeType}
                                              , ${approvalDatetime}
                                              , ${employeeNo}
                                              , ${reason}
                                              , ${totalWorkingHours})
</insert>

</mapper>